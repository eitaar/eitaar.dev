---
import BaseHead from "../components/BaseHead.astro";
import StyledFooter from "../components/Footer.astro";
import StyledHeader from "../components/Header.astro";
import "../styles/global.css";

interface Props {
	title: string;
	description?: string;
	showBackground?: boolean;
}

const { title, description = "eitaar.dev", showBackground }: Props = Astro.props;
---
<!doctype html>
<html lang="en" data-theme="dark">
	<head>
		<BaseHead title={title} description={description}/>
		<script is:inline>
		function initTheme() {
			const savedTheme = localStorage.getItem("theme");
			const theme = savedTheme || "dark";
			document.documentElement.setAttribute("data-theme", theme);
		}
		initTheme();
		</script>
	</head>
	<body>
		<header>
			<StyledHeader/>
		</header>
		<main class={showBackground? "bg-pattern":""}>
			<div class="container mx-auto">
				<slot/>
			</div>
		</main>
		<footer>
			<StyledFooter/>
		</footer>
		<script>
		function toggleTheme() {
			const currentTheme = document.documentElement.getAttribute("data-theme");
			const newTheme = currentTheme === "dark" ? "light" : "dark";
			document.documentElement.setAttribute("data-theme", newTheme);
			localStorage.setItem("theme", newTheme);
			// Dispatch custom event for theme change
			document.dispatchEvent(new CustomEvent("themeChanged"));
		}
		window.toggleTheme = toggleTheme;
		document.addEventListener("astro:after-swap", () => {
			const savedTheme = localStorage.getItem("theme") || "dark";
			document.documentElement.setAttribute("data-theme", savedTheme);
		});
		</script>
		<script src="/src/assets/src/index.ts"></script>
	</body>
</html>
